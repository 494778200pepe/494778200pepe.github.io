---
layout: post
title:  "Float在内存中的存储"
date:   2018-02-11 15:00:00 +0800
categories: C
tags: C
author: pepe
description: Float在内存中的存储.
---

### **从十进制到二进制**

* 给你举个例子吧,例如0.125D
* 0.125X2=0.25,整数部分为0
* 0.25X2=0.5,整数部分为0
* 0.5X2=1.0,整数部分为1,所以0.125化为二进制就 是0.001B
* 积的小数部分依次乘以2,直到所得的积小数部分为0为止
* 有些数无法达到0,就按要求保留
* 例如0.82D
* 0.82X2=1.64,整数部分为1
* 0.64X2=1.28,整数部分为1（注意,是用0.64乘,不是1.64）
* 0.28X2=0.56,整数部分为0
* 0.56x2=1.12,整数部分为1
* 0.12X2=0.24,整数部分为0（注意是用0.12乘,不是1.12）
* 0.24X2=0.48,整数部分为0
* 0.48X2=0.96,整数部分为0
* 0.96X2=1.92,整数部分为1.要多少位就一直乘下去,
* 0.82化为二进制就是0.11010001B.


[从十进制数转化为二进制数时小数部分应该怎么算?_作业帮](https://www.zybang.com/question/1da4bfe5c6472c8e025396f47c92bae0.html)

[二进制十进制间小数怎么转换_百度经验](https://jingyan.baidu.com/article/425e69e6e93ca9be15fc1626.html)

### **float的表示方式**

先说一下 十进制 到 float在内存中保存的转换过程：

* 第一点，所有的数字在内存是用二进制保存的
* 第二点，浮点数在内存中是按[科学计数法][Scientific counting method-url]来存储的
* 第三点，既然是用科学计数法，那么就需要保存三个信息，符号、有效值、指数值
* 第四点，float在内存中占4个字节，32个bit位
* 第五点，float表示浮点数，就是用32个bit位来保存上面的三个信息。

![float]({{ site.baseurl }}/assets/images/c/float.png)

比如：

* 0.8125，转化成二进制是：0.1101，用科学计数法表示：1.101 * 2^(-1)，小数点向右移动1位(小数点移动到第一个有效数字的右边)
* 12.5,转化成二进制是：1100.1，用科学计数法表示：1.1001 * 2^(3)，小数点向左移动3位(小数点移动到第一个有效数字的右边)

再来详细说明下上面这张图：

* 1、31位保存的是符号位，"1"代表负，"0"代表正。
* 2、23-30位，是指数位，如果指数是正的，第30位放入"1"。如果n是右移得到的或指数为0，则第30位放入"0"。
* 3、23-29位，存放指数的值，指数的范围为 0 ~ 127.
* 4、22-0位，用来表示有效值。

[(1)c语言中FLOAT 是如何表示的_爱云横_新浪博客](http://blog.sina.com.cn/s/blog_70bab92301016zqm.html)

### **精度和值范围**

#### 精度

现在说精度，我们知道精度就是有效值的范围，能精确到小数点后面几位，对吧。

22-0位，用来表示有效值。那么有效值的取值范围就在2^0 ~ 2^23 之间，但是，
由于第一位有效数字总是"1"，不必存储。
因此，由于二进制的有效值的实际上有效数字位是24位，也就是 0 ~ 8388608。
一共七位，这意味着最多能有7位有效数字，但绝对能保证的为6位，也即float的精度为6~7位有效数字

#### 再来说值范围

float在内存中保存的数值模型大概是这样子的：1.1000101*2^n，那么这个值的范围基本上可以由 2^n 来确定。
同时我们知道 n 的范围是 0 ~ 127，那么加上符号位，float的值范围大概就是 -2^127 ~ +2^127，也就是也即-3.40E+38 ~ +3.40E+38。

[C语言中关于float、double、long double精度及数值范围理解 - CSDN博客](http://blog.csdn.net/zhenganzhong_csdn/article/details/50039289)

[C语言中float double等类型在内存中的存储 - 冰岛彩虹 - 博客园](https://www.cnblogs.com/bingdaocaihong/p/6993028.html)

### 注意点

#### 第一个
上面说过，**由于有效数字位是一个二进制纯小数，而且第一位有效数字总是"1"，不必存储。**
所以，float在存储时，是需要去掉小数点左边的那个 1,然后将小数点右边的数值存储到22 - 0的bit位的

#### 第二个
指数值的存储问题。

[浮点数在计算机中的存储方式 - wuyuan2011woaini - 博客园](https://www.cnblogs.com/wuyuan2011woaini/p/4105765.html)


### **从float到值**









[Scientific counting method-url]:https://baike.baidu.com/item/%E7%A7%91%E5%AD%A6%E8%AE%B0%E6%95%B0%E6%B3%95/1612882?fr=aladdin

















